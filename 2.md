# 3D多人在线飞机模拟游戏 - 控制与视角系统需求文档

## 1. 控制系统设计

### 1.1 基础控制映射

#### 主控制组（WASD）
- **W键**：加速（增加油门）
- **S键**：减速（减少油门）
  - 地面模式：支持倒车功能
- **A键**： 
  - 空中模式：纯YAW左转
  - 地面模式：纯方向舵控制（类似汽车方向盘）
- **D键**： YAW右转
  - 空中模式：纯YAW右转
  - 地面模式：纯方向舵控制

#### 辅助控制组（方向键）
- **上箭头**：机头下压（俯冲）
  - 对应真实飞机的推杆动作
- **下箭头**：机头上抬（爬升）
  - 对应真实飞机的拉杆动作
- **左箭头**：
  - 空中模式：自动混合Roll + Yaw，实现自然向左转弯
  - 地面模式：纯方向舵控制（类似汽车方向盘）
- **右箭头**：
  - 空中模式：自动混合Roll + Yaw，实现自然向右转弯
  - 地面模式：纯方向舵控制（类似汽车方向盘）


### 1.2 模式切换逻辑

#### 地面模式触发条件
- 速度 < 40km/h **且** 高度 < 3米

#### 空中模式触发条件  
- 速度 ≥ 40km/h **或** 高度 ≥ 3米

#### 模式切换特性
- **平滑过渡**：避免突兀的控制变化
- **视觉提示**：HUD显示当前模式
- **渐进式混合**：在临界状态下混合两种模式的控制逻辑

## 3. 飞机配平系统
### 3.1 速度配平
- **目标巡航速度**：200km/h（可调节）
- **自动油门调节**：无玩家输入时自动维持目标速度
- **调节速率**：渐进式调整，避免突然变化

### 3.2 姿态配平
- **自动水平**：Roll角度自动回归0°
- **俯仰稳定**：Pitch角度趋向于配平状态
- **偏航阻尼**：减少不必要的左右摆动


## 4. 摄像机视角系统


## 核心设计理念：**第三人称跟随摄像机（Third-Person Follow Camera）**

### 1. **位置锁定机制**
- **飞机始终居中**：摄像机的目标点（LookAt Target）始终锁定在飞机的中心位置
- **固定相对距离**：摄像机与飞机保持恒定的距离，不会因为飞机的机动而改变

### 2. **平滑跟随算法**
摄像机很可能使用了以下技术：
```csharp
// 伪代码示例
Vector3 targetPosition = aircraft.position + offset;
camera.position = Vector3.Lerp(camera.position, targetPosition, smoothSpeed * Time.deltaTime);
camera.LookAt(aircraft.position);
```

### 3. **关键技术特点**

#### **位置跟随**
- 摄像机位置 = 飞机位置 + 固定偏移量
- 偏移量通常在飞机的后上方

#### **视角锁定**
- 摄像机始终朝向飞机中心点
- 使用 `LookAt()` 函数或类似的朝向计算

#### **姿态独立**
- 无论飞机如何翻滚、俯仰、偏航
- 摄像机的相对位置关系保持不变
- 背景世界会随着飞机姿态变化而"旋转"

